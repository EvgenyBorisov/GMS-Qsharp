<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var i;
//publ_var=0;
for (i=0;i&lt;CONSOLE_LINES;i++){
chat[i]='';
chat_color[i]=c_black;
chat_alpha[i]=0;
chat_l[i]=0;
history[i]='';
}
memory="";
writing_to_memory=false;

chat_active=false;
history_line=-1;
current_block=1;

caret_flash = 0
caret_flash_rate = 15
caret_move = 0
caret_move_rate = 7
text = "" // current text
caret = 0 // caret position
fillchar = "`" // used as filler character in input handling.
filltext = string_repeat(fillchar, 10);

Qinit();

console_execute("/qvm_test")
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if chat_active=true {
// keyboard shortcuts:
caret_move = max(0, caret_move - 1)
if (keyboard_check(vk_left) != keyboard_check(vk_right)) {
    if (caret_move == 0) {
        if (keyboard_check(vk_left)) {
            if (caret &gt; 0) caret -= 1
        } else {
            if (caret &lt; string_length(text)) caret += 1
        }
        caret_move = caret_move_rate
    }
} else caret_move = 0
if (keyboard_check_pressed(vk_home)) caret = 0
if (keyboard_check_pressed(vk_end)) caret = string_length(text)
if (keyboard_check_pressed(vk_delete)) {
    text = string_delete(text, caret + 1, 1)
}
// actual input:
if (keyboard_string != filltext &amp;&amp; keyboard_string != "") {
    var n, l, t;
    t = keyboard_string
    l = string_length(t)
    n = 1
    // find where actual input starts
    while ((n &lt;= l) &amp;&amp; (string_char_at(t, n) == fillchar)) n += 1
    c = 11 - n
    if (c &gt; 0 &amp;&amp; caret &gt; 0) {
        caret -= c
        text = string_delete(text, caret + 1, c)
    }
    c = l - n + 1
    if (c &gt; 0) {
        text = string_insert(string_copy(t, n, c), text, caret + 1)
        caret += c
    }
}
keyboard_string = filltext
caret = max(0, min(caret, string_length(text)))
}


for (i=0;i&lt;CONSOLE_VISISIBLE_LINES;i++){
if (chat_alpha[i]&gt;=0){
chat_alpha[i]-=0.02
}
else
{exit}
}


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Draw chat
draw_set_font(fnt_console)
draw_set_halign(fa_top)
draw_set_valign(fa_left)

if chat_active 
{
    //
    
    var i, h, ptext;
// sad truth: There is no way you can display the typed "#"
// characters and get string width of those.
ptext = string_replace_all(text, '#', 'ï¿½')
// add those useless fancy lines below the input:
i = string_width(string_copy(ptext, 1, caret))
h = string_height('\\')

draw_text_box_ext(32,view_hview[0]-32,ptext,c_white,1,300)
draw_set_colour(c_white);
draw_set_alpha(1);
draw_line(32 + i, view_hview[0]-32, 32 + i, view_hview[0]-32 + h)

// key handling:
if (keyboard_check_pressed(vk_escape)) {chat_active=false; ptext='' exit;}
if (keyboard_check_pressed(vk_enter)) {



if chat_active  {
    
    chat_active=false
    if ptext!=''{console_execute(ptext);}
    text = ''
    caret = 0
    }
}

    
    for (i=0;i&lt;CONSOLE_VISISIBLE_LINES;i++) {
        draw_text_box(32,view_hview[0]-32-20-i*20,chat[i],chat_color[i],1)
    }
}
else {
    for (i=0;i&lt;CONSOLE_VISISIBLE_LINES;i++)  {
        if chat_alpha[i]&lt;=0 {exit;} 
        else
        {draw_text_box(32,view_hview[0]-32-20-i*20,chat[i],chat_color[i],chat_alpha[i])}
    }
}







</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="89">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if not chat_active
{
keyboard_string=""
chat_active=true
history_line=-1
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="40">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if chat_active
{
history_line-=1;//max(0,history_line-1)
if history_line&lt;0 {
text="";
history_line=-1;
}
else {
text=history[history_line]
}
caret = string_length(text)
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="38">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if chat_active
{
history_line=min(CONSOLE_LINES,history_line+1)
text=history[history_line]
caret = string_length(text)
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
